<?xml version="1.0" encoding="UTF-8"?>
        <!-- Copyright 2012 Google Inc. All Rights Reserved -->
        <Module>
    	  <ModulePrefs title="Face Movement">
    	  <Require feature="rpc"/>
          <Require feature="views" />
    	</ModulePrefs>
    	<Content type="html"><![CDATA[
<!DOCTYPE html>

<script src="https://talkgadget.google.com/hangouts/_/api/hangout.js?v=1.2" ></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
<script>
$(document).ready(function(){
$("body").css("height", "100%");
$("html").css("height", "100%");
});
</script>
<div style="height:100%">
<iframe id="theIFrame" frameborder="no" scrolling="yes" src="" style="width:100%; height:100%">
Loading your MadEye project.  We'll be done in just a moment!
</iframe>
</div>

<script>var appData = gadgets.views.getParams()['appData'];
var theIFrame = document.getElementById("theIFrame");
if (appData){
  gapi.hangout.onApiReady.add(function(eventObj) {
    gapi.hangout.data.setValue("projectUrl", appData);
    var hangoutUrl = gapi.hangout.getHangoutUrl();
    var hangoutId = gapi.hangout.getHangoutId();
    theIFrame.src = appData + "?hangout=true&hangoutUrl=" + hangoutUrl + "&hangoutId=" + hangoutId;
  });
} else {
  gapi.hangout.onApiReady.add(function(eventObj) {
    var state = gapi.hangout.data.getState();
    var baseUrl;
    if (state.projectUrl){
      baseUrl = state.projectUrl;
    } else {
      baseUrl = "{{apogeeUrl}}/projectSelection";
    }
    var hangoutUrl = gapi.hangout.getHangoutUrl();
    var hangoutId = gapi.hangout.getHangoutId();
    theIFrame.src = baseUrl + "?hangout=true&hangoutUrl=" + hangoutUrl + "&hangoutId=" + hangoutId;;
  });
}
</script>
<br/>
]]></Content></Module>
